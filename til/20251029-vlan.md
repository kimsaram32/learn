# 20251029 - VLANs

## VLAN

VLAN은 가상화 기술 중 하나이다.

하나의 물리적 L2 네트워크를 여러 개의 논리적인 네트워크로 분할하는 기술이다.

## 쓰는 이유

가상화 기술이 다 그러하듯, 물리적 장치의 한계를 극복하기 위해 사용한다.
- 장비 설치의 번거로움
- 네트워크 분리만을 위해 스위치를 설치하는 것은 장치 낭비가 될 수 있다.
- 적은 호스트가 연결된 네트워크에선 포트의 낭비가 발생한다.

## 작동 방식

기본적으로 스위치 상에서 작동한다.
각각의 VLAN엔 식별자가 주어지며, 이를 통해 VLAN을 구분한다.

### Tagged/untagged VLANs

VLAN 상에서의 프레임 구성 방식에 따른 구분이다.

- tagged VLAN: 프레임 안에 VLAN id 정보가 들어 있다 (tags).
- untagged VLAN: 프레임에 VLAN 정보가 없다. 그냥 일반적인 프레임과 같다.

## VLAN 구분 방법

프레임을 받았을 때, 그것이 어느 VLAN에 속하는지 구분할 수 있어야 한다.
tagged/untagged냐에 따라 그 방법이 다르다.

- tagged인 경우 당연히 해당 프레임 안에 있는 id로 구분할 것이다...
- untagged일 경우 port로 구분하는 것이 가장 기본적이다.

## access port와 trunk port

access port는 untagged, trunk port는 tagged VLAN을 사용하는 port라고 생각하면 된다

## switch와 host와의 연결 - untagged

호스트와 스위치가 연결될 때는 untagged VLAN 방식을 사용한다.

호스트는 VLAN 정보를 신경 쓰지 않아도 네트워크에 잘 연결될 수 있어야 한다.
때문에 프레임에 추가 처리가 필요 없는 untagged VLAN을 사용한다.

## switch 끼리의 연결 - tagged, trunking

스위치끼리 연결될 때, 보통 trunking이라는 것을 적용한다.

trunking은 하나의 link로 여러 VLAN이 활성화된 스위치를 연결하는 것이다.
이는 tagged VLAN으로 구현한다.

trunking을 쓰지 않기로 한다면, untagged 방식을 통해 한 VLAN마다 port를 사용해 연결해주어야 할 것이다.
즉 스위치끼리의 연결에 필요한 port 수가 VLAN의 수에 비례하게 되므로, 매우 비효율적이게 된다.
따라서 trunking을 사용하는 것이다.

## Todo

high-level적인 이해는 다 했는데 세부 구현까지는 잘 모른다...
- tagged VLAN의 specification. IEEE에서 제정한 게 있다고 함
- VTP 등의 관련 프로토콜
