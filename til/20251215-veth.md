# 20251215 - veth

## Linux veth

Linux의 veth은 virtual ethernet device이다.
veth device는 항상 2개의 pair로써 연결된 virtual network device로 쌍을 이루어 존재한다.

device는 서로 다른 network namespace에 속해있을 수 있다.
따라서 주로 container networking에서 사용되지만, 이것만으로 용도가 한정된 것은 아니다.

## 실습

다음과 같은 작업을 진행하였다.

1.  veth device pair를 생성하였다 - `vethtest0`, `vethtest1`
2.  `vethtest1` 을 network namespace인 `testns` 에 두었다.
3.  둘 사이의 통신을 테스트하였다.

### Create a network namespace

    ip netns add testns

### Create a veth device pair

    ip link add vethtest0 type veth peer vethtest1 netns testns

    ip link show dev vethtest0
    ip -n testns link show dev vethtest1

### Add IP addresses

    ip addr add 10.0.1.1/24 dev vethtest0
    ip -n testns addr add 10.0.1.2/24 dev vethtest1

    ip addr show dev vethtest0
    ip -n testns addr show dev vethtest1

### Activate devices

    ip link set vethtest0 up
    ip -n testns link set vethtest1 up

### Ping each other

    ping -c 3 10.0.1.2
    ip netns exec testns ping -c 3 10.0.1.1

### Cleaning up

    ip link delete vethtest0
    ip netns delete testns
